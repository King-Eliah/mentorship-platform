import{c as P,u as L,r,z as p,R as j,j as e,v as c,s as F,w as M,t as q,X as K,I as $}from"./index-DmCLvhFB.js";import{C as N}from"./Modal-BQ2qUe9G.js";import{U as G}from"./upload-DXxW-GZO.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=P("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Q=()=>{const{user:i}=L(),[U,v]=r.useState(!1),[S,d]=r.useState([]),[u,k]=r.useState("all"),[O,m]=r.useState(!1),[I,f]=r.useState(!1),[A,h]=r.useState(!1),[E,y]=r.useState(!1),[n,b]=r.useState({title:"",description:"",category:"learning-materials",tags:"",isPublic:!0}),[o,C]=r.useState(null);r.useEffect(()=>{T()},[]);const T=async()=>{v(!0);try{const t=JSON.parse(localStorage.getItem("resources")||"[]");if(t.length>0)d(t);else{const a=[{id:"1",title:"Mentoring Best Practices Guide",description:"A comprehensive guide on effective mentoring techniques",category:"learning-materials",fileName:"mentoring-guide.pdf",originalFileName:"mentoring-guide.pdf",fileSize:2048e3,uploadedBy:"Admin",uploadedAt:new Date().toISOString(),downloadCount:45},{id:"2",title:"Goal Setting Template",description:"Template for setting SMART goals in mentoring relationships",category:"templates",fileName:"goal-template.docx",originalFileName:"goal-template.docx",fileSize:512e3,uploadedBy:"Admin",uploadedAt:new Date().toISOString(),downloadCount:23}];d(a),localStorage.setItem("resources",JSON.stringify(a))}}catch(t){console.error("Failed to fetch resources:",t),p.error("Failed to load resources"),d([])}finally{v(!1)}},z=async()=>{if(!n.title.trim()||!o){h(!0);return}try{const t=await new Promise((g,w)=>{const s=new FileReader;s.onload=()=>g(s.result),s.onerror=w,s.readAsDataURL(o)}),a={id:Date.now().toString(),title:n.title,description:n.description,category:n.category,fileName:o.name,originalFileName:o.name,fileSize:o.size,uploadedBy:i?.firstName+" "+i?.lastName||"Unknown",uploadedAt:new Date().toISOString(),downloadCount:0,fileData:t,fileType:o.type};d(g=>[a,...g]);const l=JSON.parse(localStorage.getItem("resources")||"[]");localStorage.setItem("resources",JSON.stringify([a,...l])),m(!1),b({title:"",description:"",category:"learning-materials",tags:"",isPublic:!0}),C(null),f(!0),window.dispatchEvent(new CustomEvent("resourcesUpdated"))}catch(t){console.error("Failed to upload resource:",t),p.error("Failed to upload file")}},B=async t=>{try{const a=t.fileData||t.fileUrl;if(!a){p.error("File data not available");return}const l=document.createElement("a");l.href=a,l.download=t.originalFileName||t.fileName,document.body.appendChild(l),l.click(),document.body.removeChild(l),d(s=>s.map(x=>x.id===t.id?{...x,downloadCount:x.downloadCount+1}:x));const w=JSON.parse(localStorage.getItem("resources")||"[]").map(s=>s.id===t.id?{...s,downloadCount:s.downloadCount+1}:s);localStorage.setItem("resources",JSON.stringify(w)),y(!0)}catch(a){console.error("Failed to download resource:",a),p.error("Failed to download file")}},J=i?.role===j.ADMIN||i?.role===j.MENTOR,R=i?.role===j.MENTEE,D=(()=>{if(u==="shared-with-me"&&R){const t=JSON.parse(localStorage.getItem(`shared_resources_${i?.id}`)||"[]");return S.filter(a=>t.includes(a.id))}return S})();return U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Resource Manager"}),e.jsx("p",{className:"mt-1 text-gray-600 dark:text-gray-400",children:"Manage and access resources for the mentorship program"})]}),J&&e.jsxs(c,{onClick:()=>m(!0),children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Upload Resource"]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>k("all"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${u==="all"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"All Resources"}),R&&e.jsx("button",{onClick:()=>k("shared-with-me"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${u==="shared-with-me"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"Shared With Me"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(t=>e.jsx(F,{children:e.jsxs(M,{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-gray-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400 mb-2",children:[e.jsxs("span",{children:["Uploaded by ",t.uploadedBy]}),e.jsx("span",{children:new Date(t.uploadedAt).toLocaleDateString()})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(c,{variant:"outline",size:"sm",onClick:()=>B(t),title:"Download",children:e.jsx(H,{className:"w-4 h-4"})})})]})},t.id))}),D.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:u==="shared-with-me"?"No resources shared with you yet":"No resources found"})}),O&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(F,{className:"w-full max-w-md",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Upload Resource"}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>m(!1),children:e.jsx(K,{className:"w-4 h-4"})})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx($,{label:"Title",value:n.title,onChange:t=>b(a=>({...a,title:t.target.value})),required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:t=>b(a=>({...a,description:t.target.value})),placeholder:"Enter resource description...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"File"}),e.jsx("input",{type:"file",onChange:t=>{const a=t.target.files?.[0];a&&C(a)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),o&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Selected: ",o.name]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(c,{onClick:z,className:"flex-1",children:"Upload Resource"}),e.jsx(c,{variant:"outline",onClick:()=>m(!1),className:"flex-1",children:"Cancel"})]})]})]})}),e.jsx(N,{isOpen:I,onClose:()=>f(!1),onConfirm:()=>f(!1),title:"Upload Successful",message:"Your file has been uploaded successfully!",confirmText:"OK",variant:"info"}),e.jsx(N,{isOpen:A,onClose:()=>h(!1),onConfirm:()=>h(!1),title:"Upload Failed",message:"Please enter a title and select a file before uploading.",confirmText:"OK",variant:"danger"}),e.jsx(N,{isOpen:E,onClose:()=>y(!1),onConfirm:()=>y(!1),title:"Download Started",message:"Your file download has started successfully!",confirmText:"OK",variant:"info"})]})};export{Q as ResourceManager};
