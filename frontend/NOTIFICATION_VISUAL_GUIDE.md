# Notification System - Visual Guide

**Date:** November 2, 2025

---

## ðŸ”” What the Notification Bell Looks Like

### Before: Dropdown

```
[ðŸ””â‚ƒ] <- Click â†’ Shows dropdown with notifications
```

### Now: Page Link

```
[ðŸ””â‚ƒ] <- Click â†’ Navigates to /notifications page
```

The bell shows:

- **Icon:** ðŸ”” notification bell
- **Badge:** Red circle with number (unread count)
- **Example:** [ðŸ””â‚…] means 5 unread notifications

---

## ðŸ“‹ Notifications Page Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚  Notifications              Mark All Read (5)           â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ â— New message from John Doe              2 minutes ago  â”‚
â”‚   "Hey, how's the project going?"                       â”‚
â”‚                                      [Mark Read]        â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ â— Contact request from Sarah Smith       1 hour ago    â”‚
â”‚   "Sarah Smith sent you a contact request"             â”‚
â”‚                                      [Mark Read]        â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   New group message in Project Team      3 hours ago   â”‚
â”‚   "Meeting notes uploaded in resources"                â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ [More notifications...]                               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â— = Unread (blue dot indicator)
  = Read (no dot)
```

---

## ðŸ“± Dashboard Recent Messages Card

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ“¨ Recent Messages   View All      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  John Doe                  2m ago   â”‚
â”‚  "Hey, did you get my email about  â”‚
â”‚   the project?"                    â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Sarah Smith              45m ago   â”‚
â”‚  "Thanks for the feedback on my    â”‚
â”‚   proposal."                       â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Team Lead               2h ago    â”‚
â”‚  "Next sprint planning meeting    â”‚
â”‚   is scheduled for tomorrow."     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”„ User Flow: Receiving a Message

### Step 1: Send Message

```
User A (Frontend)          User A (Backend)
    â”‚                          â”‚
    â”œâ”€ Types message    â”€â”€â†’    â”œâ”€ GET /api/messages
    â”‚                          â”‚
    â”œâ”€ Clicks send      â”€â”€â†’    â”œâ”€ POST /api/messages
    â”‚                          â”‚
    â”‚                          â”œâ”€ Create message in DB
    â”‚                          â”‚
    â”‚                          â”œâ”€ Create notification for User B
    â”‚                          â”‚   (userId: userB_id)
    â”‚                          â”‚   (type: MESSAGE)
    â”‚                          â”‚   (isRead: false)
    â”‚                          â”‚
    â”‚                    â†â”€â”€   â”œâ”€ Return success
```

### Step 2: Recipient Sees Notification

```
User B (Frontend)                   User B (Backend)
    â”‚                                   â”‚
    â”œâ”€ Polls: GET /api/notif  â”€â†’     â”œâ”€ Query notifications
    â”‚                                   â”‚   WHERE userId = userB_id
    â”‚                                   â”‚   AND isRead = false
    â”‚                                   â”‚
    â”‚                          â†â”€    â”œâ”€ Return {
    â”‚                                   â”‚   "notifications": [
    â”‚                                   â”‚     {title: "New message"}
    â”‚                                   â”‚   ],
    â”‚                                   â”‚   "unreadCount": 1
    â”‚                                   â”‚ }
    â”‚
    â”œâ”€ Bell shows "1"
    â”‚
    â”œâ”€ User clicks bell
    â”‚
    â”œâ”€ Shows /notifications page
    â”‚  with notification list
```

### Step 3: Mark as Read

```
User B Clicks "Mark Read"
    â”‚
    â”œâ”€ PATCH /api/notifications/{id}/read
    â”‚
    â”œâ”€ Backend: update notification
    â”‚   SET isRead = true
    â”‚
    â”œâ”€ Frontend: remove from unread list
    â”‚  or show as read (grayed out)
    â”‚
    â””â”€ Bell badge disappears (0 unread)
```

---

## ðŸŽ¯ When Notifications Are Created

### 1. Direct Message Sent

```
Trigger: messageController.sendMessage()
â”‚
â”œâ”€ Create Notification
â”‚  â”œâ”€ userId: recipient_id
â”‚  â”œâ”€ type: MESSAGE
â”‚  â”œâ”€ title: "New message from John Doe"
â”‚  â”œâ”€ message: "First 50 chars of message..."
â”‚  â””â”€ isRead: false
```

### 2. Group Message Posted

```
Trigger: messageController.sendMessage(groupId)
â”‚
â”œâ”€ Get all group members
â”‚  (except the sender)
â”‚
â”œâ”€ For each member:
â”‚  â””â”€ Create Notification
â”‚     â”œâ”€ userId: member_id
â”‚     â”œâ”€ type: GROUP
â”‚     â”œâ”€ title: "New message in ProjectTeam"
â”‚     â”œâ”€ message: "John posted: 'Update...'"
â”‚     â””â”€ isRead: false
```

### 3. Contact Request Sent

```
Trigger: contactController.sendContactRequest()
â”‚
â”œâ”€ Create Notification
â”‚  â”œâ”€ userId: recipient_id
â”‚  â”œâ”€ type: SYSTEM
â”‚  â”œâ”€ title: "Contact request from John Doe"
â”‚  â”œâ”€ message: "John Doe sent you a request"
â”‚  â””â”€ isRead: false
```

### 4. Contact Request Accepted

```
Trigger: contactController.acceptContactRequest()
â”‚
â”œâ”€ Create Notification
â”‚  â”œâ”€ userId: requester_id
â”‚  â”œâ”€ type: SYSTEM
â”‚  â”œâ”€ title: "Contact request accepted"
â”‚  â”œâ”€ message: "Sarah accepted your request"
â”‚  â””â”€ isRead: false
```

---

## ðŸ“Š Database Storage

### Notification Table

```sql
Notification
â”œâ”€ id: UUID (primary key)
â”œâ”€ userId: UUID (who receives)
â”œâ”€ type: ENUM (MESSAGE, GROUP, SYSTEM, etc)
â”œâ”€ title: VARCHAR (e.g., "New message from John")
â”œâ”€ message: VARCHAR (e.g., "Hey, how are you?")
â”œâ”€ link: VARCHAR (optional, for click action)
â”œâ”€ isRead: BOOLEAN (default: false)
â””â”€ createdAt: TIMESTAMP

Indexes:
â”œâ”€ ON userId (fast: find user's notifications)
â”œâ”€ ON isRead (fast: find unread)
â””â”€ ON createdAt (fast: sort by date)
```

---

## ðŸ”— API Endpoint Flows

### GET /api/notifications

```
Request:
  GET http://localhost:5000/api/notifications
  Headers: { Authorization: "Bearer TOKEN" }

Response (200 OK):
{
  "notifications": [
    {
      "id": "abc123",
      "userId": "user123",
      "type": "MESSAGE",
      "title": "New message from John",
      "message": "Hello, how are you?",
      "link": null,
      "isRead": false,
      "createdAt": "2025-11-02T10:30:00Z"
    },
    {
      "id": "def456",
      "userId": "user123",
      "type": "SYSTEM",
      "title": "Contact request accepted",
      "message": "Sarah accepted your request",
      "link": null,
      "isRead": true,
      "createdAt": "2025-11-02T09:15:00Z"
    }
  ],
  "unreadCount": 3
}
```

### PATCH /api/notifications/:id/read

```
Request:
  PATCH http://localhost:5000/api/notifications/abc123/read
  Headers: { Authorization: "Bearer TOKEN" }

Response (200 OK):
{
  "notification": {
    "id": "abc123",
    "userId": "user123",
    "type": "MESSAGE",
    "title": "New message from John",
    "message": "Hello, how are you?",
    "isRead": true,  â† CHANGED TO TRUE
    "createdAt": "2025-11-02T10:30:00Z"
  }
}
```

### PATCH /api/notifications/all/read

```
Request:
  PATCH http://localhost:5000/api/notifications/all/read
  Headers: { Authorization: "Bearer TOKEN" }

Response (200 OK):
{
  "message": "All notifications marked as read"
}
```

---

## ðŸ–¼ï¸ Navbar Layout

### Before

```
[ðŸ””] [ðŸ‘¤ Profile]
```

### Now

```
[ðŸ””â‚ƒ] [ðŸ‘¤ Profile]
  â†“
  Clicking bell navigates to /notifications
  (no dropdown on click)
```

---

## ðŸ“² Mobile Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard              â”‚ â† Bell icon top right
â”‚ [Home] [Messages] [ðŸ””â‚ƒ]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚ Recent Messages         â”‚ â† Responsive card
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ John Doe   5m ago â”‚   â”‚
â”‚ â”‚ "Hey there!"      â”‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â”‚ Sarah      1h ago â”‚   â”‚
â”‚ â”‚ "Thanks"          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŽ¨ Color Scheme

### Light Mode

- **Background:** White
- **Border:** Light gray
- **Text:** Dark gray
- **Unread badge:** Red
- **Unread highlight:** Light blue background

### Dark Mode

- **Background:** Dark gray
- **Border:** Medium gray
- **Text:** Light gray/white
- **Unread badge:** Red (same)
- **Unread highlight:** Medium blue background

---

## â±ï¸ Time Formatting

```
Notification created: 2025-11-02 10:30:00
Current time: 2025-11-02 10:32:15

Display: "2 minutes ago"

Examples:
â”œâ”€ 30 seconds ago    â†’ "Just now"
â”œâ”€ 5 minutes ago     â†’ "5m ago"
â”œâ”€ 1 hour ago        â†’ "1h ago"
â”œâ”€ 3 hours ago       â†’ "3h ago"
â”œâ”€ 1 day ago         â†’ "1d ago"
â””â”€ 5 days ago        â†’ "Nov 2"
```

---

## ðŸŽ¯ Test Scenario

### Scenario: User A Sends Message to User B

**Timeline:**

```
10:00 AM
  User A: Writes message "Hey, how's it going?"
          Clicks Send

â†“ Backend processes (1 second)

10:00:01 AM
  Backend: Creates message in DB
           Creates notification for User B
           â”œâ”€ userId: User B's ID
           â”œâ”€ type: MESSAGE
           â”œâ”€ title: "New message from User A"
           â”œâ”€ message: "Hey, how's it going?"
           â””â”€ isRead: false

â†“ Frontend polls (every 2-5 seconds)

10:00:05 AM
  User B's app polls /api/notifications
           Sees new notification
           Shows bell: [ðŸ””â‚]

User B: Sees bell with "1"
        Clicks bell

â†“ Navigation

10:00:06 AM
  User B: On /notifications page
          Sees notification in list
          Clicks "Mark Read"

â†“ API call

10:00:07 AM
  Backend: Updates notification
           SET isRead = true

  Frontend: Notification no longer shows as unread
            Bell badge disappears: [ðŸ””]
```

---

**All systems ready! Send a test message to see notifications in action.** âœ…
