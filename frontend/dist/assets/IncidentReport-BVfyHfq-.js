import{r as l,j as e,p as Ae,v as m,X as J,R as G,z as v,s as P,w as F,A as j,g as ge,U as ce,S as ae,I as M,H as oe,ac as U,C as Ie,K as De}from"./index-D-GftGfX.js";import{u as Te}from"./useAuth-CdvU4mZm.js";import{C as Re,D as A}from"./DropdownSelect--kHvkzTf.js";import{U as Pe}from"./upload-IwIswNRH.js";import{I as Fe,F as Me}from"./image-Z5mpZoI6.js";import{F as I}from"./file-text-CcTvu0KD.js";import{C as Be}from"./ConfirmationDialog-BfKwI29D.js";import{L as ze,C as Oe}from"./Skeleton-CQgzE1YK.js";import{P as Ee}from"./plus-CuHoAZkc.js";import{F as le}from"./filter-CpaVX3qe.js";import{S as he}from"./send-CFzuSHL9.js";const Le=({onFileSelect:n,onFileRemove:S,acceptedTypes:x=["image/*",".pdf",".doc",".docx",".txt"],maxFileSize:u=10,maxFiles:V=5,multiple:c=!0,showPreview:D=!0,className:b="",disabled:h=!1,children:N,uploadText:Z="Click to upload or drag and drop",dragText:w="Drop files here"})=>{const[T,W]=l.useState(!1),[f,K]=l.useState([]),[B,r]=l.useState([]),C=l.useRef(null),z=l.useCallback(t=>{const d=o=>{if(o.size>u*1024*1024)return`File "${o.name}" is too large. Maximum size is ${u}MB.`;if(x.length>0){const k=o.type,R=o.name.toLowerCase();if(!x.some(p=>{if(p.startsWith("."))return R.endsWith(p);if(p.includes("/*")){const L=p.split("/")[0];return k.startsWith(L)}return k===p}))return`File "${o.name}" has an unsupported format. Accepted types: ${x.join(", ")}.`}return null},g=[],y=[];if(Array.from(t).forEach(o=>{const k=d(o);if(k){y.push(k);return}if(f.length+g.length>=V){y.push(`Maximum ${V} files allowed.`);return}const R=Object.assign(o,{id:Date.now().toString()+Math.random().toString(36).substr(2,9)});if(D&&o.type.startsWith("image/")){const _=new FileReader;_.onload=p=>{R.preview=p.target?.result,K(L=>[...L])},_.readAsDataURL(o)}g.push(R)}),g.length>0){const o=c?[...f,...g]:g;K(o),n(o)}r(y)},[f,V,c,n,D,x,u]),Y=l.useCallback(t=>{t.preventDefault(),t.stopPropagation()},[]),q=l.useCallback(t=>{t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&W(!0)},[]),X=l.useCallback(t=>{t.preventDefault(),t.stopPropagation(),W(!1)},[]),Q=l.useCallback(t=>{t.preventDefault(),t.stopPropagation(),W(!1),!h&&t.dataTransfer.files&&t.dataTransfer.files.length>0&&z(t.dataTransfer.files)},[h,z]),ee=l.useCallback(t=>{h||t.target.files&&t.target.files.length>0&&z(t.target.files)},[h,z]),O=t=>{const d=f.filter((g,y)=>y!==t);K(d),n(d),S?.(t),C.current&&(C.current.value="")},se=()=>{!h&&C.current&&C.current.click()},E=t=>t.type.startsWith("image/")?e.jsx(Fe,{className:"h-5 w-5 text-blue-500"}):t.type.includes("pdf")?e.jsx(I,{className:"h-5 w-5 text-red-500"}):t.type.includes("word")||t.type.includes("document")?e.jsx(I,{className:"h-5 w-5 text-blue-600"}):e.jsx(Me,{className:"h-5 w-5 text-gray-500"}),H=t=>{if(t===0)return"0 Bytes";const d=1024,g=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(t)/Math.log(d));return parseFloat((t/Math.pow(d,y)).toFixed(2))+" "+g[y]};return e.jsxs("div",{className:`w-full ${b}`,children:[e.jsxs("div",{className:`
          relative border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 cursor-pointer
          ${T?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}
          ${h?"opacity-50 cursor-not-allowed":""}
          bg-white dark:bg-gray-800
        `,onClick:se,onDragEnter:q,onDragLeave:X,onDragOver:Y,onDrop:Q,children:[e.jsx("input",{ref:C,type:"file",className:"hidden",multiple:c,accept:x.join(","),onChange:ee,disabled:h}),N||e.jsxs("div",{className:"space-y-2",children:[e.jsx(Pe,{className:`mx-auto h-8 w-8 ${T?"text-blue-500":"text-gray-400 dark:text-gray-500"}`}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.jsx("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:T?w:Z})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.join(", ")," up to ",u,"MB"]})]})]}),B.length>0&&e.jsx("div",{className:"mt-3 space-y-1",children:B.map((t,d)=>e.jsxs("div",{className:"flex items-center text-sm text-red-600 dark:text-red-400",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2 flex-shrink-0"}),t]},d))}),D&&f.length>0&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Selected Files (",f.length,")"]}),e.jsx("div",{className:"space-y-2",children:f.map((t,d)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[t.preview?e.jsx("img",{src:t.preview,alt:t.name,className:"h-10 w-10 object-cover rounded border border-gray-200 dark:border-gray-600"}):e.jsx("div",{className:"h-10 w-10 flex items-center justify-center bg-white dark:bg-gray-600 rounded border border-gray-200 dark:border-gray-600",children:E(t)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:H(t.size)})]}),e.jsx(Re,{className:"h-4 w-4 text-green-500 flex-shrink-0"})]}),e.jsx(m,{onClick:g=>{g.stopPropagation(),O(d)},variant:"ghost",size:"sm",className:"ml-2 text-gray-400 hover:text-red-500",disabled:h,children:e.jsx(J,{className:"h-4 w-4"})})]},t.id))})]})]})},de=[{value:"harassment",label:"Harassment",description:"Inappropriate behavior or communication",icon:e.jsx(ce,{className:"w-4 h-4"})},{value:"discrimination",label:"Discrimination",description:"Unfair treatment based on protected characteristics",icon:e.jsx(U,{className:"w-4 h-4"})},{value:"misconduct",label:"Professional Misconduct",description:"Violation of professional standards",icon:e.jsx(j,{className:"w-4 h-4"})},{value:"safety",label:"Safety Concern",description:"Physical or digital safety issues",icon:e.jsx(j,{className:"w-4 h-4"})},{value:"technical",label:"Technical Issue",description:"System or platform problems",icon:e.jsx(I,{className:"w-4 h-4"})},{value:"other",label:"Other",description:"Other types of incidents",icon:e.jsx(le,{className:"w-4 h-4"})}],re=[{value:"low",label:"Low",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",icon:e.jsx(ge,{className:"w-4 h-4"}),description:"Minor issue"},{value:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",icon:e.jsx(j,{className:"w-4 h-4"}),description:"Moderate concern"},{value:"high",label:"High",color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",icon:e.jsx(j,{className:"w-4 h-4"}),description:"Urgent issue"},{value:"critical",label:"Critical",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",icon:e.jsx(j,{className:"w-4 h-4"}),description:"Immediate attention"}],Ye=()=>{const{user:n}=Te(),[S,x]=l.useState([]),[u,V]=l.useState([]),[c,D]=l.useState(""),[b,h]=l.useState("all"),[N,Z]=l.useState("all"),[w,T]=l.useState("all"),[W,f]=l.useState(!1),[K,B]=l.useState(!1),[r,C]=l.useState(null),[z,Y]=l.useState(!0),[q,X]=l.useState(""),[Q,ee]=l.useState(null),[O,se]=l.useState(!1),[E,H]=l.useState(""),[t,d]=l.useState({title:"",type:"other",severity:"medium",description:"",location:"",involvedParties:"",witnessNames:"",isAnonymous:!1}),[g,y]=l.useState([]),[o,k]=l.useState({isOpen:!1,incidentId:null,incidentTitle:""});l.useEffect(()=>{_()},[]);const R=l.useCallback(()=>{let s=S;c&&(s=s.filter(a=>a.title.toLowerCase().includes(c.toLowerCase())||a.description.toLowerCase().includes(c.toLowerCase())||a.involvedParties.some(i=>i.toLowerCase().includes(c.toLowerCase())))),b!=="all"&&(s=s.filter(a=>a.type===b)),N!=="all"&&(s=s.filter(a=>a.status===N)),w!=="all"&&(s=s.filter(a=>a.severity===w)),n?.role!==G.ADMIN&&(s=s.filter(a=>a.reportedById===n?.id||a.involvedParties.includes(`${n?.firstName} ${n?.lastName}`))),s.sort((a,i)=>a.priority!==i.priority?i.priority-a.priority:new Date(i.reportedAt).getTime()-new Date(a.reportedAt).getTime()),V(s)},[S,c,b,N,w,n]);l.useEffect(()=>{R()},[R]);const _=async()=>{Y(!0);try{await new Promise(a=>setTimeout(a,800)),x([{id:"1",title:"Inappropriate communication in group chat",type:"harassment",severity:"high",description:"A group member has been sending inappropriate messages in the team chat, making other members uncomfortable.",location:"Online - Group Chat",involvedParties:["John Doe","Group Alpha"],witnessNames:"Multiple group members",reportedAt:"2025-09-14T09:30:00Z",reportedBy:"Anonymous",reportedById:"user-1",status:"investigating",assignedTo:"HR Team",attachments:[{id:"att-1",name:"chat-screenshots.png",url:"/evidence/chat-screenshots.png",type:"image/png",size:245760}],isAnonymous:!0,priority:4,updatedAt:"2025-09-14T14:20:00Z"},{id:"2",title:"System access issue affecting mentor dashboard",type:"technical",severity:"medium",description:"Multiple mentors are unable to access their dashboard features, affecting their ability to track mentee progress.",location:"Platform Dashboard",involvedParties:["Platform System"],reportedAt:"2025-09-13T16:45:00Z",reportedBy:"Dr. Sarah Johnson",reportedById:"mentor-1",status:"resolved",assignedTo:"Technical Team",resolution:"Database connection issue was identified and fixed. All mentors should now have full access to dashboard features.",attachments:[],isAnonymous:!1,priority:3,updatedAt:"2025-09-13T18:30:00Z",resolvedAt:"2025-09-13T18:30:00Z"},{id:"3",title:"Safety concern about meeting location",type:"safety",severity:"medium",description:"The assigned meeting room for mentor sessions is in a poorly lit area with limited security. Several participants have expressed concerns.",location:"Building C, Room 101",involvedParties:["Facilities Team"],witnessNames:"Emily Chen, Mike Davis",reportedAt:"2025-09-12T11:15:00Z",reportedBy:"Lisa Rodriguez",reportedById:"user-3",status:"open",attachments:[{id:"att-2",name:"location-photos.jpg",url:"/evidence/location-photos.jpg",type:"image/jpeg",size:512e3}],isAnonymous:!1,priority:3,updatedAt:"2025-09-12T11:15:00Z"},{id:"4",title:"Unprofessional behavior during group session",type:"misconduct",severity:"high",description:"A participant was disruptive during the group mentoring session, using inappropriate language and refusing to follow session guidelines.",location:"Conference Room A",involvedParties:["Alex Thompson"],witnessNames:"All group session participants",reportedAt:"2025-09-10T14:00:00Z",reportedBy:"Session Facilitator",reportedById:"mentor-2",status:"closed",assignedTo:"Program Director",resolution:"Participant has been counseled and agreed to follow session guidelines. Additional training on professional behavior has been provided.",attachments:[],isAnonymous:!1,priority:4,updatedAt:"2025-09-11T10:00:00Z",resolvedAt:"2025-09-11T10:00:00Z"}])}catch(s){console.error("Failed to fetch incidents:",s),v.error("Failed to load incident reports")}finally{Y(!1)}},p=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=s=>{switch(s){case"open":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"investigating":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"resolved":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"closed":return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},me=s=>re.find(i=>i.value===s)?.color||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",pe=s=>s>=4?"text-red-600 dark:text-red-400":s>=3?"text-orange-600 dark:text-orange-400":s>=2?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400",ue=()=>{D(""),h("all"),Z("all"),T("all"),v.success("Filters cleared")},ie=c!==""||b!=="all"||N!=="all"||w!=="all",$=s=>{const{name:a,value:i,type:Se}=s.target;d(Ce=>({...Ce,[a]:Se==="checkbox"?s.target.checked:i}))},ye=s=>{y(s)},fe=(s,a)=>{let i=1;return s==="harassment"||s==="discrimination"?i=4:s==="misconduct"||s==="safety"?i=3:s==="technical"&&(i=2),a==="critical"?5:a==="high"?Math.min(5,i+1):a==="medium"?i:Math.max(1,i-1)},ve=async()=>{if(!t.title.trim()||!t.description.trim()){v.error("Please fill in the required fields");return}try{await new Promise(a=>setTimeout(a,1e3));const s={id:Math.random().toString(36),title:t.title,type:t.type,severity:t.severity,description:t.description,location:t.location||void 0,involvedParties:t.involvedParties.split(",").map(a=>a.trim()).filter(a=>a),witnessNames:t.witnessNames||void 0,reportedAt:new Date().toISOString(),reportedBy:t.isAnonymous?"Anonymous":`${n?.firstName} ${n?.lastName}`,reportedById:n?.id||"",status:"open",attachments:g.map(a=>({id:Math.random().toString(36),name:a.name,url:URL.createObjectURL(a),type:a.type,size:a.size})),isAnonymous:t.isAnonymous,priority:fe(t.type,t.severity),updatedAt:new Date().toISOString()};x(a=>[s,...a]),v.success("Incident report submitted successfully"),ne()}catch{v.error("Failed to submit incident report")}},ne=()=>{f(!1),d({title:"",type:"other",severity:"medium",description:"",location:"",involvedParties:"",witnessNames:"",isAnonymous:!1}),y([])},je=s=>{C(s),B(!0)},be=(s,a)=>{k({isOpen:!0,incidentId:s,incidentTitle:a})},Ne=()=>{o.incidentId&&(x(s=>s.filter(a=>a.id!==o.incidentId)),v.success("Incident report deleted successfully"),k({isOpen:!1,incidentId:null,incidentTitle:""}))},we=()=>{k({isOpen:!1,incidentId:null,incidentTitle:""})},xe=s=>{if(!q.trim()){v.error("Please enter a resolution message");return}x(a=>a.map(i=>i.id===s?{...i,resolution:q,status:"resolved",resolvedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}:i)),v.success("Incident resolved successfully"),X(""),ee(null)},ke=s=>{if(!E.trim()){v.error("Please enter a resolution message");return}x(a=>a.map(i=>i.id===s?{...i,resolution:E,resolvedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}:i)),C(a=>a?{...a,resolution:E,resolvedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}:null),v.success("Resolution updated successfully"),se(!1),H("")},te=n?.role===G.ADMIN;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:"Incident Reports"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mt-1",children:te?"Review and resolve safety and conduct incidents":"Report and track safety and conduct incidents"})]}),!te&&e.jsxs(m,{onClick:()=>f(!0),className:"min-w-[44px] min-h-[44px] w-full sm:w-auto bg-red-600 hover:bg-red-700",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Report Incident"]})]}),te&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(P,{className:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"w-8 h-8 text-red-600 dark:text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:"Critical"}),e.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:S.filter(s=>s.severity==="critical").length})]})]})})}),e.jsx(P,{className:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400",children:"Open"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:S.filter(s=>s.status==="open"||s.status==="investigating").length})]})]})})}),e.jsx(P,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:S.length})]})]})})}),e.jsx(P,{className:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"Resolved"}),e.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:S.filter(s=>s.status==="resolved"||s.status==="closed").length})]})]})})})]}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(M,{placeholder:"Search incidents...",value:c,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsx(A,{options:[{value:"all",label:"All Types",icon:e.jsx(le,{className:"w-4 h-4"}),description:"Show all incident types"},...de.map(s=>({value:s.value,label:s.label,icon:s.icon,description:s.description}))],value:b,onChange:h,placeholder:"Select Type"}),e.jsx(A,{options:[{value:"all",label:"All Severities",icon:e.jsx(j,{className:"w-4 h-4"}),description:"Show all severity levels"},...re.map(s=>({value:s.value,label:s.label,icon:s.icon,description:s.description}))],value:w,onChange:T,placeholder:"Select Severity"}),e.jsx(A,{options:[{value:"all",label:"All Status",icon:e.jsx(oe,{className:"w-4 h-4"}),description:"Show all status types"},{value:"open",label:"Open",icon:e.jsx(I,{className:"w-4 h-4"}),description:"New incidents"},{value:"investigating",label:"Investigating",icon:e.jsx(ae,{className:"w-4 h-4"}),description:"Under investigation"},{value:"resolved",label:"Resolved",icon:e.jsx(U,{className:"w-4 h-4"}),description:"Issue resolved"},{value:"closed",label:"Closed",icon:e.jsx(J,{className:"w-4 h-4"}),description:"Case closed"}],value:N,onChange:Z,placeholder:"Select Status"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[u.length," incident",u.length!==1?"s":""]})})]}),e.jsxs("div",{className:"hidden md:grid md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(M,{placeholder:"Search incidents...",value:c,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsx(A,{options:[{value:"all",label:"All Types",icon:e.jsx(le,{className:"w-4 h-4"}),description:"Show all incident types"},...de.map(s=>({value:s.value,label:s.label,icon:s.icon,description:s.description}))],value:b,onChange:h,placeholder:"Select Type"}),e.jsx(A,{options:[{value:"all",label:"All Severities",icon:e.jsx(j,{className:"w-4 h-4"}),description:"Show all severity levels"},...re.map(s=>({value:s.value,label:s.label,icon:s.icon,description:s.description}))],value:w,onChange:T,placeholder:"Select Severity"}),e.jsx(A,{options:[{value:"all",label:"All Status",icon:e.jsx(oe,{className:"w-4 h-4"}),description:"Show all status types"},{value:"open",label:"Open",icon:e.jsx(I,{className:"w-4 h-4"}),description:"New incidents"},{value:"investigating",label:"Investigating",icon:e.jsx(ae,{className:"w-4 h-4"}),description:"Under investigation"},{value:"resolved",label:"Resolved",icon:e.jsx(U,{className:"w-4 h-4"}),description:"Issue resolved"},{value:"closed",label:"Closed",icon:e.jsx(J,{className:"w-4 h-4"}),description:"Case closed"}],value:N,onChange:Z,placeholder:"Select Status"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[u.length," incident",u.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[ie&&e.jsx(m,{variant:"ghost",size:"sm",onClick:ue,className:"text-xs px-2 py-1 h-auto",children:"Clear filters"}),e.jsxs(m,{variant:"ghost",size:"sm",className:`min-w-[44px] min-h-[44px] ${ie?"text-primary-600 bg-primary-50 dark:bg-primary-900/20":""}`,children:[e.jsx(le,{className:"w-4 h-4"}),ie&&e.jsx("span",{className:"ml-1 text-xs",children:"â€¢"})]})]})]})]})]})}),z?e.jsx(ze,{items:5,itemComponent:Oe}):e.jsx("div",{className:"space-y-3",children:u.map(s=>e.jsx(P,{className:"hover:shadow-lg transition-shadow border-l-4 border-l-red-500 overflow-hidden",children:e.jsxs(F,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:s.title}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${L(s.status)}`,children:s.status}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${me(s.severity)}`,children:s.severity}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded",children:s.type.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center truncate",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),s.reportedBy]}),e.jsxs("span",{className:"flex items-center flex-shrink-0",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),p(s.reportedAt)]}),s.location&&e.jsxs("span",{className:"flex items-center truncate",children:["ðŸ“ ",s.location]}),s.attachments.length>0&&e.jsxs("span",{className:"flex items-center flex-shrink-0",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),s.attachments.length]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>je(s),className:"h-8 px-2",children:e.jsx(oe,{className:"w-3 h-3"})}),n?.role===G.ADMIN&&!s.resolution&&s.status!=="resolved"&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>ee(Q===s.id?null:s.id),className:"h-8 px-2 text-green-600 hover:text-green-700",children:e.jsx(U,{className:"w-3 h-3"})}),(te||s.reportedById===n?.id)&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>be(s.id,s.title),className:"h-8 px-2 text-red-600 hover:text-red-700",children:e.jsx(De,{className:"w-3 h-3"})})]})]}),n?.role===G.ADMIN&&Q===s.id&&!s.resolution&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(M,{placeholder:"Enter resolution details...",value:q,onChange:a=>X(a.target.value),className:"flex-1 text-sm",onKeyDown:a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),xe(s.id))}}),e.jsxs(m,{size:"sm",onClick:()=>xe(s.id),className:"h-8 px-3 bg-green-600 hover:bg-green-700",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Resolve"]})]})}),s.resolution&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border-l-2 border-green-400 p-2 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(U,{className:"w-3 h-3 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-xs font-medium text-green-900 dark:text-green-100",children:"Resolution"}),s.resolvedAt&&e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:p(s.resolvedAt)})]}),e.jsx("p",{className:"text-green-800 dark:text-green-200 text-xs line-clamp-2",children:s.resolution})]})]})},s.id))}),u.length===0&&e.jsx(P,{children:e.jsxs(F,{className:"text-center py-12",children:[e.jsx(j,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No incident reports found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:c||b!=="all"||N!=="all"||w!=="all"?"Try adjusting your search criteria":"No incident reports have been submitted yet"})]})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 dark:text-white",children:"Report Incident"}),e.jsx("button",{onClick:ne,className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(J,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(j,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Important Information"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"This form is for reporting serious incidents that require immediate attention. For general feedback or minor issues, please use the Feedback Center."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Incident Title *"}),e.jsx(M,{name:"title",value:t.title,onChange:$,placeholder:"Brief description of the incident",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(A,{label:"Incident Type *",value:t.type,onChange:s=>d(a=>({...a,type:s})),placeholder:"Select incident type",options:de})}),e.jsx("div",{children:e.jsx(A,{label:"Severity Level *",value:t.severity,onChange:s=>d(a=>({...a,severity:s})),placeholder:"Select severity level",options:re})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Detailed Description *"}),e.jsx("textarea",{name:"description",value:t.description,onChange:$,placeholder:"Provide a detailed description of what happened, when it occurred, and any relevant context...",rows:5,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent min-h-[120px]",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Location (if applicable)"}),e.jsx(M,{name:"location",value:t.location,onChange:$,placeholder:"e.g., Room 101, Online platform, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Witness Names (if any)"}),e.jsx(M,{name:"witnessNames",value:t.witnessNames,onChange:$,placeholder:"Names of any witnesses"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Involved Parties (comma-separated)"}),e.jsx(M,{name:"involvedParties",value:t.involvedParties,onChange:$,placeholder:"Names of people involved in the incident"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Evidence/Attachments"}),e.jsx(Le,{onFileSelect:ye,acceptedTypes:["image/*","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document",".txt"],maxFileSize:10,maxFiles:5,multiple:!0,showPreview:!0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Upload any relevant screenshots, documents, or other evidence"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isAnonymous",name:"isAnonymous",checked:t.isAnonymous,onChange:$,className:"w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500"}),e.jsx("label",{htmlFor:"isAnonymous",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Submit this report anonymously"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 p-4 sm:p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(m,{variant:"secondary",onClick:ne,className:"min-w-[44px] min-h-[44px]",children:"Cancel"}),e.jsx(m,{onClick:ve,className:"bg-red-600 hover:bg-red-700 min-w-[44px] min-h-[44px]",children:"Submit Report"})]})]})}),K&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Incident Report Details"}),e.jsx("button",{onClick:()=>B(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(J,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white break-words",children:r.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full capitalize whitespace-nowrap ${L(r.status)}`,children:r.status}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full capitalize whitespace-nowrap ${me(r.severity)}`,children:r.severity}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded capitalize whitespace-nowrap",children:r.type.replace("-"," ")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 min-w-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Reported by:"}),e.jsx("p",{className:"text-gray-900 dark:text-white break-words",children:r.reportedBy})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Date & Time:"}),e.jsx("p",{className:"text-gray-900 dark:text-white break-words",children:p(r.reportedAt)})]}),r.location&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Location:"}),e.jsx("p",{className:"text-gray-900 dark:text-white break-words",children:r.location})]}),r.assignedTo&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Assigned to:"}),e.jsx("p",{className:"text-gray-900 dark:text-white break-words",children:r.assignedTo})]})]}),e.jsxs("div",{className:"space-y-4 min-w-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Priority:"}),e.jsxs("p",{className:`font-medium ${pe(r.priority)}`,children:[r.priority,"/5"]})]}),r.witnessNames&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Witnesses:"}),e.jsx("p",{className:"text-gray-900 dark:text-white break-words",children:r.witnessNames})]}),r.involvedParties.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Involved Parties:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r.involvedParties.map((s,a)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-sm rounded break-words",children:s},a))})]})]})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Description:"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-2 whitespace-pre-wrap break-words",children:r.description})]}),r.attachments.length>0&&e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Attachments:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:r.attachments.map(s=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center p-3 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors min-w-0",children:[e.jsx(I,{className:"w-5 h-5 text-gray-500 mr-3"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(s.size/1024).toFixed(1),"KB"]})]})]},s.id))})]}),r.resolution&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"Resolution"}),r.resolvedAt&&e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:["Resolved on ",p(r.resolvedAt)]})]}),n?.role===G.ADMIN&&e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>{se(!O),O||H(r.resolution||"")},className:"text-green-600 hover:text-green-700",children:O?"Cancel":"Edit"})]}),O?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:E,onChange:s=>H(s.target.value),className:"w-full p-2 border border-green-300 dark:border-green-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",rows:4}),e.jsxs(m,{size:"sm",onClick:()=>ke(r.id),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Save Changes"]})]}):e.jsx("p",{className:"text-green-800 dark:text-green-200 text-sm whitespace-pre-wrap",children:r.resolution})]}),!r.resolution&&r.reportedById===n?.id&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-l-4 border-gray-300 dark:border-gray-600 p-4",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No resolution yet. An admin will review this incident soon."})})]}),e.jsx("div",{className:"flex justify-end p-4 sm:p-6 border-t border-gray-200 dark:border-gray-700",children:e.jsx(m,{onClick:()=>B(!1),className:"min-w-[44px] min-h-[44px]",children:"Close"})})]})}),e.jsx(Be,{isOpen:o.isOpen,title:"Delete Incident Report",message:`Are you sure you want to delete the incident report "${o.incidentTitle}"? This action cannot be undone.`,onConfirm:Ne,onCancel:we,confirmText:"Delete Report",cancelText:"Cancel",confirmVariant:"danger"})]})};export{Ye as IncidentReport};
